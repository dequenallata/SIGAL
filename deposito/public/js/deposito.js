"use strict";var deposito=angular.module("deposito",["ui.bootstrap","angularUtils.directives.dirPagination","ngSanitize","ui.select","directive.loading"]);deposito.config(function($interpolateProvider){$interpolateProvider.startSymbol("{#"),$interpolateProvider.endSymbol("#}")}).filter("capitalize",function(){return function(input,all){return input?input.replace(/([^\W_]+[^\s-]*) */g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()}):""}}).filter("propsFilter",function(){return function(items,props){var out=[];if(angular.isArray(items)){var keys=Object.keys(props);items.forEach(function(item){for(var itemMatches=!1,i=0;i<keys.length;i++){var prop=keys[i],text=props[prop].toLowerCase();if(-1!==item[prop].toString().toLowerCase().indexOf(text)){itemMatches=!0;break}}itemMatches&&out.push(item)})}else out=items;return out}}).filter("codeforma",function(){return function(input){return input?(length=input.indexOf("-")+1,input.substring(length)):void 0}}),angular.module("directive.loading",[]).directive("loading",["$http",function($http){return{restrict:"A",link:function(scope,elm,attrs){scope.isLoading=function(){return $http.pendingRequests.length>0},scope.$watch(scope.isLoading,function(v){v?elm.show():elm.hide()})}}}]),deposito.controller("menuController",function($scope,$http,$modal){$scope.deposito=function(){$modal.open({animation:!0,templateUrl:"/cambiarDeposito",controller:"cambiaDepositoController",resolve:{obtenerUsuarios:function(){return $scope.obtenerUsuarios}}})},$scope.password=function(){$modal.open({animation:!0,templateUrl:"/cambiarPassword",controller:"cambiaPasswordController"})}}),deposito.controller("cambiaDepositoController",function($scope,$http,$modalInstance){$scope.deposito,$scope.depositos=[],$scope.alert={},$http.get("/getDeposito").success(function(response){$scope.deposito=response}),$http.get("/depositos/getDepositos").success(function(response){$scope.depositos=response}),$scope.modificar=function(){$scope.save()},$scope.save=function(){var data={deposito:$scope.depositoM};$http.post("/editarDeposito",data).success(function(response){return"success"==response.status?($modalInstance.dismiss("cancel"),void location.reload()):void($scope.alert={type:response.status,msg:response.menssage})})},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(){$scope.alert={}}}),deposito.controller("cambiaPasswordController",function($scope,$http,$modalInstance){$scope.alert={},$scope.data={},$scope.modificar=function(){$scope.save()},$scope.save=function(){$http.post("/cambiarPassword",$scope.data).success(function(response){return"success"==response.status?void $modalInstance.dismiss("cancel"):void($scope.alert={type:response.status,msg:response.menssage})})},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(){$scope.alert={}}}),$(document).ready(function(){function hamburger_cross(){1==isClosed?(overlay.hide(),trigger.removeClass("is-open"),trigger.addClass("is-closed"),isClosed=!1):(overlay.show(),trigger.removeClass("is-closed"),trigger.addClass("is-open"),isClosed=!0)}var trigger=$(".hamburger"),overlay=$(".overlay"),isClosed=!1;trigger.click(function(){hamburger_cross()}),$('[data-toggle="offcanvas"]').click(function(){$("#wrapper").toggleClass("toggled")})}),$(window).load(function(){$("#loader").fadeOut("fast")}),angular.module("deposito").controller("departamentosController",function($scope,$http,$modal){$scope.departamentos=[],$scope.cRegistro="5",$scope.obtenerDepartamentos=function(){$http.get("/getDepartamentos").success(function(response){$scope.departamentos=response})},$scope.registrarDepartamento=function(){$modal.open({animation:!0,templateUrl:"/registrarDepartamento",size:"lg",controller:"registrarDepartamentoCtrl",resolve:{obtenerDepartamentos:function(){return $scope.obtenerDepartamentos}}})},$scope.editarDepartamento=function(index){$modal.open({animation:!0,templateUrl:"/editarDepartamento",size:"lg",controller:"editarDepartamentoCtrl",resolve:{obtenerDepartamentos:function(){return $scope.obtenerDepartamentos},id:function(){return index}}})},$scope.eliminarDepartamento=function(index){$modal.open({animation:!0,templateUrl:"/eliminarDepartamento",controller:"eliminarDepartamentoCtrl",resolve:{obtenerDepartamentos:function(){return $scope.obtenerDepartamentos},id:function(){return index}}})},$scope.obtenerDepartamentos()}),angular.module("deposito").controller("registrarDepartamentoCtrl",function($scope,$modalInstance,$http,obtenerDepartamentos){$scope.btnVisivilidad=!0,$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/registrarDepartamento",$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerDepartamentos()})}}),angular.module("deposito").controller("editarDepartamentoCtrl",function($scope,$modalInstance,$http,obtenerDepartamentos,id){$scope.btnVisivilidad=!0,$scope.nombre="",$http.get("/getDepartamento/"+id).success(function(response){$scope.nombre=response.nombre}),$scope.modificar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/editarDepartamento/"+id,$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerDepartamentos()})}}),angular.module("deposito").controller("eliminarDepartamentoCtrl",function($scope,$modalInstance,$http,obtenerDepartamentos,id){$scope.btnVisivilidad=!0,$scope.eliminar=function(){$scope.delet()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.delet=function(){$http.post("/eliminarDepartamento/"+id).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerDepartamentos()})}}),angular.module("deposito").controller("depositosController",function($scope,$http,$modal){$scope.deposito=[],$scope.cRegistro="5",$scope.obtenerDepositos=function(){$http.get("/depositos/getDepositos").success(function(response){$scope.depositos=response})},$scope.registrarDeposito=function(){$modal.open({animation:!0,templateUrl:"/depositos/registrarDeposito",size:"lg",controller:"registrarDepositoCtrl",resolve:{obtenerDepositos:function(){return $scope.obtenerDepositos}}})},$scope.editarDeposito=function(index){$modal.open({animation:!0,templateUrl:"/depositos/editarDeposito",size:"lg",controller:"editarDepositoCtrl",resolve:{obtenerDepositos:function(){return $scope.obtenerDepositos},id:function(){return index}}})},$scope.eliminarDeposito=function(index){$modal.open({animation:!0,templateUrl:"/depositos/eliminarDeposito",controller:"eliminarDepositoCtrl",resolve:{obtenerDepositos:function(){return $scope.obtenerDepositos},id:function(){return index}}})},$scope.obtenerDepositos()}),angular.module("deposito").controller("registrarDepositoCtrl",function($scope,$modalInstance,$http,obtenerDepositos){$scope.btnVisivilidad=!0,$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/depositos/registrarDeposito",$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerDepositos()})}}),angular.module("deposito").controller("editarDepositoCtrl",function($scope,$modalInstance,$http,obtenerDepositos,id){$scope.btnVisivilidad=!0,$scope.nombre="",$http.get("/depositos/getDeposito/"+id).success(function(response){$scope.nombre=response.nombre,$scope.codigo=response.codigo}),$scope.modificar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/depositos/editarDeposito/"+id,$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerDepositos()})}}),angular.module("deposito").controller("eliminarDepositoCtrl",function($scope,$modalInstance,$http,obtenerDepositos,id){$scope.btnVisivilidad=!0,$scope.eliminar=function(){$scope.delet()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.delet=function(){$http.post("/depositos/eliminarDeposito/"+id).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerDepositos()})}}),angular.module("deposito").controller("entradasController",function($scope,$http,$modal){function visivility(menu){switch(menu){case 1:$scope.uiStatus.proformas=!0,$scope.uiStatus.insumos=!1,$scope.uiStatus.ordenes=!1;break;case 2:$scope.uiStatus.proformas=!1,$scope.uiStatus.insumos=!0,$scope.uiStatus.ordenes=!1;break;case 3:$scope.uiStatus.proformas=!1,$scope.uiStatus.insumos=!1,$scope.uiStatus.ordenes=!0}}$scope.entradas=[],$scope.indice="Pro-Formas",$scope.insumos=[],$scope.insumosDon=[],$scope.cRegistro="5",$scope.orden={},$scope.insumos=[],$scope.uiStatus={proformas:!0,insumos:!1,ordenes:!1};var obtenerEntradas=function(datos,query){switch(datos){case"orden":$http.get("/entradas/getEntradas/"+datos).success(function(response){$scope.entradas=response});break;case"donacion":$http.get("/entradas/getEntradas/"+datos).success(function(response){$scope.entradas=response});break;case"devolucion":$http.get("/entradas/getEntradas/"+datos).success(function(response){$scope.entradas=response});break;case"toda":$http.get("/entradas/getEntradas").success(function(response){$scope.entradas=response});break;case"search":$http.get("/entradas/getSearch",query).success(function(response){$scope.entradas=response})}},obtenerInsumos=function(datos){switch(datos){case"orden":$http.get("/entradas/getInsumos/"+datos).success(function(response){$scope.insumos=response});break;case"donacion":$http.get("/entradas/getInsumos/"+datos).success(function(response){$scope.insumos=response});break;case"devolucion":$http.get("/entradas/getInsumos/"+datos).success(function(response){$scope.insumos=response});break;case"todo":$http.get("/entradas/getInsumos").success(function(response){$scope.insumos=response})}};$scope.registrosEntradas=function(datos){switch($scope.busqueda="",$scope.indice="Pro-Formas",$scope.entradas=[],visivility(1),datos){case"ordenes":obtenerEntradas("orden");break;case"donaciones":obtenerEntradas("donacion");break;case"devoluciones":obtenerEntradas("devolucion");break;case"todas":obtenerEntradas("toda")}},$scope.registrosInsumos=function(datos){switch($scope.busqueda="",$scope.indice="Insumos",$scope.insumos=[],visivility(2),datos){case"ordenes":obtenerInsumos("orden");break;case"donaciones":obtenerInsumos("donacion");break;case"devoluciones":obtenerInsumos("devolucion");break;case"todos":obtenerInsumos("todo")}},$scope.detallesOrden=function(orden){$http.get("/entradas/getOrden/"+orden).success(function(response){$scope.orden=response.orden,$scope.insumos=response.insumos,visivility(3),$scope.busqueda="",$scope.indice="Orden"})},$scope.detallesEntrada=function(index){$modal.open({animation:!0,templateUrl:"/entradas/detalles",controller:"detallesEntradaCtrl",windowClass:"large-Modal",resolve:{id:function(){return index}}})},$scope.search=function(){visivility(1);$modal.open({animation:!0,templateUrl:"/entradas/search",controller:"serarchEntradaCtrl",windowClass:"large-Modal",resolve:{obtenerEntradas:function(){return obtenerEntradas}}})},obtenerEntradas("toda")}),angular.module("deposito").controller("detallesEntradaCtrl",function($scope,$modalInstance,$http,id){$scope.entrada={},$scope.insumos=[],$scope.visibility=!1,$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.chvisibility=function(){$scope.search={},$scope.visibility=!$scope.visibility},$scope.detalles=function(){$http.get("/entradas/getEntrada/"+id).success(function(response){$scope.nota=response.nota,$scope.insumos=response.insumos})},$scope.detalles(id)}),angular.module("deposito").controller("serarchEntradaCtrl",function($scope,$modalInstance,$http,obtenerEntradas){function dateForamat(data){if(null!=data){var month=data.getMonth()+1,day=data.getDate();return 10>day&&(day="0"+day),10>month&&(month="0"+month),data.getFullYear()+"-"+month+"-"+day}}function timeFormat(time){var hour=time.getHours(),minute=time.getMinutes();return 10>hour&&(hour="0"+hour),10>minute&&(minute="0"+minute),hour+"-"+minute}$scope.data={},$scope.data.type="all",$scope.data.orden="desc",$scope.insumoSelect={},$scope.userSelect={},$scope.proveSelect={},$http.get("getUsuariosDeposito").success(function(response){var usuarios=response,userSet=[];for(var index in usuarios){var usuario={nombre:usuarios[index].nombre+" "+usuarios[index].apellido,id:usuarios[index].id};userSet.push(usuario)}$scope.usuarios=userSet}),$scope.refreshInsumos=function(insumo){$scope.searchAjax=!0;var params={insumo:insumo};return $http.get("/inventario/getInsumosInventario",{params:params}).then(function(response){$scope.listInsumos=response.data})},$scope.buscar=function(){parseInsumo(),parseAmount(),parseUser(),parseProve(),parseDate(),parseTime();var config={params:$scope.data};obtenerEntradas("search",config),$modalInstance.dismiss("cancel")},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.insumoSearch=function(){$scope.insumop=!$scope.insumop},$scope.dateSearch=function(){$scope.datep=!$scope.datep},$scope.timeSearch=function(){$scope.timep=!$scope.timep,$scope.timeI=new Date,$scope.timeF=new Date},$scope.openI=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedI=!0},$scope.openF=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedF=!0},$scope.provedorType=function(type){"all"!=type?($scope.provedorp=!0,"devolucion"==type?($scope.proveSelect={},$http.get("/getDepartamentos").success(function(response){$scope.provedores=response})):($scope.proveSelect={},$http.get("/getProvedores").success(function(response){$scope.provedores=response}))):$scope.provedorp=!1};var parseInsumo=function(){$scope.insumop&&$scope.insumoSelect.hasOwnProperty("selected")&&($scope.data.insumo=$scope.insumoSelect.selected.id)},parseAmount=function(){$scope.data.cantidadI&&$scope.data.cantidadF&&($scope.data.amountrange=!0)},parseUser=function(){$scope.userSelect.hasOwnProperty("selected")&&($scope.data.user=$scope.userSelect.selected.id)},parseProve=function(){$scope.proveSelect.hasOwnProperty("selected")&&($scope.data.prove=$scope.proveSelect.selected.id)},parseDate=function(){$scope.datep&&$scope.fechaI&&$scope.fechaF&&($scope.data.fechaI=dateForamat($scope.fechaI),$scope.data.fechaF=dateForamat($scope.fechaF),$scope.data.dateranger=!0)},parseTime=function(){$scope.timep&&($scope.data.horaI=timeFormat($scope.timeI),$scope.data.horaF=timeFormat($scope.timeF),$scope.data.hourrange=!0)}}),angular.module("deposito").controller("estadisticasController",function($scope,$http){function estadisticas(){$http.get("/getEstadisticas").success(function(response){chartOption.series[0].data=response.Sdata,chartOption.drilldown.series=response.Ddata,chartOption.yAxis.title.text="Salidas de insumos",chartOption.title.text=response.title,chartOption.subtitle.text="Haga click en una columna para ver los insumos que han salido por servicio",$(function(){$("#graficaInicial").highcharts(chartOption)})})}function dataForamat(data){if(null!=data){var month=data.getMonth()+1,day=data.getDate();return 10>day&&(day="0"+day),10>month&&(month="0"+month),data.getFullYear()+"-"+month+"-"+day}}$scope.formVisivility=!0,$scope.servicio=null,$scope.departamentos=[],$scope.listInsumos=[],$scope.insumoSelect={},$scope.alert={},$scope.dI=null,$scope.dF=null,$scope.searchAjax=!1,$http.get("/getDepartamentos").success(function(response){$scope.departamentos=response}),$scope.openI=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedI=!0},$scope.openF=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedF=!0},$scope.refreshInsumos=function(insumo){$scope.searchAjax=!0;var params={insumo:insumo};return $http.get("/getInsumosConsulta",{params:params}).then(function(response){$scope.listInsumos=response.data})},$scope.formConsulta=function(){$scope.formVisivility=!1},$scope.formCerrar=function(){$scope.formVisivility=!0};var chartOption={chart:{type:"column"},title:{text:""},subtitle:{text:""},xAxis:{type:"category"},yAxis:{title:{text:""}},legend:{enabled:!1},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y}"}}},tooltip:{headerFormat:'<span style="font-size:11px">{series.name}</span><br>',pointFormat:'<span style="color:{point.color}">{point.name}</span>: <b>{point.y}</b> Unidades<br/>'},series:[{name:"Salidas",colorByPoint:!0,data:[]}],drilldown:{series:[]}};$scope.closeAlert=function(){$scope.alert={}},$scope.consultaInsumo=function(){$scope.searchAjax=!1;var data={fechaI:dataForamat($scope.dI),fechaF:dataForamat($scope.dF),insumo:$scope.insumoSelect.hasOwnProperty("selected")?$scope.insumoSelect.selected.id:null};$http.post("/estadisticasInsumo",data).success(function(response){return"success"==response.status?(chartOption.title.text=response.title,chartOption.subtitle.text="",chartOption.series[0].data=response.data,chartOption.drilldown.series=[],void $(function(){$("#graficaInicial").highcharts(chartOption)})):void($scope.alert={type:response.status,msg:response.menssage})})},$scope.consultaServicio=function(){var data={fechaI:dataForamat($scope.dI),fechaF:dataForamat($scope.dF),servicio:$scope.servicio};$http.post("/estadisticasServicio",data).success(function(response){return"success"==response.status?(chartOption.title.text=response.title,chartOption.subtitle.text="",chartOption.series[0].data=response.data,chartOption.drilldown.series=[],void $(function(){$("#graficaInicial").highcharts(chartOption)})):void($scope.alert={type:response.status,msg:response.menssage})})},estadisticas()}),angular.module("deposito").controller("alertController",function($scope,$http){function insumoExist(codigo){var index;for(index in $scope.insumos)if($scope.insumos[index].codigo==codigo)return!0;return!1}function empaquetaData(){var index,insumos=[];for(index in $scope.insumos)insumos.push({id:$scope.insumos[index].id,min:$scope.insumos[index].min,med:$scope.insumos[index].med});return insumos}function restablecer(){$scope.insumos=[]}function validaCantidad(){var index;for(index in $scope.insumos){if(!$scope.insumos[index].min||$scope.insumos[index].min<=0||!Number.isInteger($scope.insumos[index].min))return!1;if(!$scope.insumos[index].med||$scope.insumos[index].med<=0||!Number.isInteger($scope.insumos[index].med))return!1;if($scope.insumos[index].min>=$scope.insumos[index].med)return!1}return!0}$scope.insumoSelect={},$scope.listInsumos=[],$scope.insumos=[],$scope.refreshInsumos=function(insumo){var params={insumo:insumo};return $http.get("/inventario/herramientas/getInventarioAlert",{params:params}).then(function(response){$scope.listInsumos=response.data})},$scope.agregarInsumos=function(){return $scope.insumoSelect.selected?insumoExist($scope.insumoSelect.selected.codigo)?void($scope.alert={type:"danger",msg:"Este insumo ya se ha agregado"}):($scope.insumos.unshift({id:$scope.insumoSelect.selected.id,codigo:$scope.insumoSelect.selected.codigo,descripcion:$scope.insumoSelect.selected.descripcion,min:$scope.insumoSelect.selected.min,med:$scope.insumoSelect.selected.med}),void($scope.insumoSelect={})):void($scope.alert={type:"danger",msg:"Por favor especifique un insumo"})},$scope.eliminarInsumo=function(index){$scope.insumos.splice(index,1)},$scope.existInsumos=function(){return 0!=$scope.insumos.length},$scope.closeAlert=function(){$scope.alert={},$},$scope.guardar=function(){if(!validaCantidad())return void($scope.alert={type:"danger",msg:"Especifique un valor valido para cada insumo"});var data={insumos:empaquetaData()};$http.post("/inventario/herramientas/estableceAlarmas",data).success(function(response){$scope.alert={type:response.status,msg:response.menssage},"success"==response.status&&($scope.alert={type:response.status,msg:response.menssage},restablecer())})}}).controller("cargaInvController",function($scope,$http,$modal){function insumoExist(codigo,insumos){var index;for(index in insumos)if(insumos[index].codigo==codigo)return!0;return!1}function empaquetaData(insumosOri){var index,insumos=[];for(index in insumosOri)insumos.push({id:insumosOri[index].id,cantidad:insumosOri[index].cantidad});return insumos}function validaCantidad(insumos){var index;for(index in insumos)if(!insumos[index].cantidad||insumos[index].cantidad<0||!Number.isInteger($scope.insumos[index].cantidad))return!1;return!0}$scope.insumoSelect={},$scope.departamentos=[],$scope.departamento,$scope.insumos=[],$scope.listInsumos=[],$scope.alert={type:"warning",msg:"Precaucion! la carga de inventario eliminara todos los insumos cargados previamente."},$scope.refreshInsumos=function(insumo){var params={insumo:insumo};return $http.get("/getInsumosConsulta",{params:params}).then(function(response){$scope.listInsumos=response.data})},$scope.agregarInsumos=function(){return $scope.insumoSelect.selected?insumoExist($scope.insumoSelect.selected.codigo,$scope.insumos)?void($scope.alert={type:"danger",msg:"Este insumo ya se ha agregado en esta entrada"}):($scope.insumos.unshift({id:$scope.insumoSelect.selected.id,codigo:$scope.insumoSelect.selected.codigo,descripcion:$scope.insumoSelect.selected.descripcion}),void($scope.insumoSelect={})):void($scope.alert={type:"danger",msg:"Por favor especifique un insumo"})},$scope.closeAlert=function(){$scope.alert={}},$scope.thereInsumos=function(){return $scope.insumos.length>0},$scope.eliminarInsumo=function(index){$scope.insumos.splice(index,1)},$scope.restablecer=function(){$scope.insumos=[],$scope.alert={}},$scope.registrar=function(){return validaCantidad($scope.insumos)?($scope.modalInstance=$modal.open({animation:!0,templateUrl:"confirmeRegister.html",scope:$scope}),$scope.cancel=function(){$scope.modalInstance.dismiss("cancel")},void($scope.cofirme=function(){save(),$scope.modalInstance.dismiss("cancel"),$scope.loader=!0})):void($scope.alert={type:"danger",msg:"Especifique un valor valido para cada insumo"})};var save=function(){var data={insumos:empaquetaData($scope.insumos)};$http.post("/inventario/herramientas/cargaInventario",data).success(function(response){return $scope.loader=!1,"success"==response.status?($modal.open({animation:!0,templateUrl:"successRegister.html",controller:"successRegisterCtrl",resolve:{response:function(){return response}}}),void $scope.restablecer()):void($scope.alert={type:response.status,msg:response.menssage})})}}).controller("listCargasController",function($scope,$http,$modal){$scope.entradas=[],$scope.cRegistro="5",$http.get("/inventario/herramientas/getInventarioCargas").success(function(response){$scope.entradas=response}),$scope.detallesCarga=function(index){$modal.open({animation:!0,templateUrl:"/inventario/herramientas/detallesCarga",controller:"detallesCargaCtrl",windowClass:"large-Modal",resolve:{id:function(){return index}}})}}),angular.module("deposito").controller("detallesCargaCtrl",function($scope,$modalInstance,$http,id){$scope.entrada={},$scope.insumos=[],$scope.visibility=!1,$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.chvisibility=function(){$scope.search={},$scope.visibility=!$scope.visibility},$http.get("/inventario/herramientas/getInventarioCarga/"+id).success(function(response){$scope.nota=response.nota,$scope.insumos=response.insumos})}),angular.module("deposito").controller("successRegisterCtrl",function($scope,$modalInstance,response){$scope.response=response,$scope.ok=function(){$modalInstance.dismiss("cancel")}}),angular.module("deposito").controller("insumosAlertController",function($scope,$http,$modal){$scope.insumos=[],$scope.cRegistro="5",$scope.obtenerInsumos=function(){$http.get("/inventario/getAlertInsumos").success(function(response){$scope.insumos=response})},$scope.calculaEstatus=function(min,med,exit){return min>=exit?"danger":med>=exit?"warning":void 0},$scope.obtenerInsumos()}),angular.module("deposito").controller("insumosController",function($scope,$http,$modal){$scope.insumos=[],$scope.cRegistro="5",$scope.registrarInsumo=function(){$modal.open({animation:!0,templateUrl:"/registrarInsumo",size:"lg",controller:"registraInsumoCtrl",resolve:{obtenerInsumos:function(){return $scope.obtenerInsumos}}})},$scope.obtenerInsumos=function(){$scope.ver=!0,$http.get("/getInsumos").success(function(response){$scope.insumos=response,$scope.ver=!1})},$scope.editarInsumo=function(index){$modal.open({animation:!0,templateUrl:"/editarInsumo",size:"lg",controller:"editarInsumoCtrl",resolve:{obtenerInsumos:function(){return $scope.obtenerInsumos},id:function(){return index}}})},$scope.elimInsumo=function(index){$modal.open({animation:!0,templateUrl:"/eliminarInsumo",controller:"eliminarInsumoCtrl",resolve:{obtenerInsumos:function(){return $scope.obtenerInsumos},id:function(){return index}}})},$scope.obtenerInsumos()}),angular.module("deposito").controller("registraInsumoCtrl",function($scope,$modalInstance,$http,obtenerInsumos){$scope.btnVisivilidad=!0,$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={codigo:$scope.codigo,descripcion:$scope.descripcion};$http.post("/registrarInsumo",$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,"success"==response.status&&obtenerInsumos()})}}),angular.module("deposito").controller("editarInsumoCtrl",function($scope,$modalInstance,$http,obtenerInsumos,id){$scope.btnVisivilidad=!0,$scope.codigo="",$scope.descripcion="",$http.get("/getInsumo/"+id).success(function(response){$scope.codigo=response.codigo,$scope.descripcion=response.descripcion}),$scope.modificar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={codigo:$scope.codigo,descripcion:$scope.descripcion};$http.post("/editarInsumo/"+id,$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,"success"==response.status&&obtenerInsumos()})}}),angular.module("deposito").controller("eliminarInsumoCtrl",function($scope,$modalInstance,$http,obtenerInsumos,id){$scope.btnVisivilidad=!0,$scope.eliminar=function(){$scope.delet()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.delet=function(){$http.post("/eliminarInsumo/"+id).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,"success"==response.status&&obtenerInsumos()})}}),angular.module("deposito").controller("inventarioController",function($scope,$http,$modal){function empaquetaData(insumos){var insumosSelect=[];for(var insumo in insumos)insumos[insumo].select&&insumosSelect.push(insumos[insumo].id);return insumosSelect}$scope.insumos=[],$scope.cRegistro="5",$scope.status=!1,$scope.all=!1;var obtenerInsumos=function(data){$http.post("/inventario/getInventario",data).success(function(response){$scope.insumos=response.insumos,$scope.dateI=response.dateI,$scope.dateF=response.dateF,$scope.calculaEstatus($scope.insumos)})};$scope.calculaEstatus=function(insumos){for(var insumo in insumos)insumos[insumo].existencia<=insumos[insumo].min?insumos[insumo].color="danger":insumos[insumo].existencia<=insumos[insumo].med?insumos[insumo].color="warning":insumos[insumo].color=""},$scope.parcialInventario=function(){$scope.status=!0},$scope.closeSelect=function(){$scope.status=!1,$scope.unselectInsumos(),$scope.calculaEstatus($scope.insumos),$scope.all=!1},$scope.unselectInsumos=function(){for(var insumo in $scope.insumos)$scope.insumos[insumo].select=!1,$scope.insumos[insumo].color=""},$scope.select=function(){$scope.all?$scope.selectAll():$scope.unselectInsumos()},$scope.selectAll=function(){if($scope.busqueda)for(var insumo in $scope.insumos){var descripcion=$scope.insumos[insumo].descripcion.toLowerCase(),busqueda=$scope.busqueda.toLowerCase();-1!=descripcion.indexOf(busqueda)&&($scope.insumos[insumo].color="success",$scope.insumos[insumo].select=!0)}else for(var insumo in $scope.insumos)$scope.insumos[insumo].color="success",$scope.insumos[insumo].select=!0},$scope.selectInsumo=function(index){0!=$scope.status&&($scope.insumos[index].select?($scope.insumos[index].color="",$scope.insumos[index].select=!1):($scope.insumos[index].color="success",$scope.insumos[index].select=!0))},$scope.gerenarParcial=function(){var data={insumos:empaquetaData($scope.insumos)};$scope.thereIsSelect()&&$http.post("/reportes/getInventario",data,{responseType:"arraybuffer"}).success(function(response){var file=new Blob([response],{type:"application/pdf"}),fileURL=URL.createObjectURL(file);window.open(fileURL)})},$scope.thereIsSelect=function(){for(var insumo in $scope.insumos)if($scope.insumos[insumo].select)return!0;return!1},$scope.search=function(){$scope.busqueda={},$scope.barSearch=!$scope.barSearch},$scope.dateSelect=function(){$scope.modalInstance=$modal.open({animation:!0,templateUrl:"date.html",controller:"dateCtrl",resolve:{obtenerInsumos:function(){return obtenerInsumos}}})},$scope.current=function(){obtenerInsumos()},$scope.move=function(){var data={date:$scope.dateF,move:!0};obtenerInsumos(data)},obtenerInsumos()}),angular.module("deposito").controller("dateCtrl",function($scope,$modalInstance,obtenerInsumos){function dateForamat(date){if(null!=date){var month=date.getMonth()+1,day=date.getDate();return 10>day&&(day="0"+day),10>month&&(month="0"+month),date.getFullYear()+"-"+month+"-"+day}}function rangeDate(date){return date.getTime()<(new Date).getTime()}$scope.alert={},$scope.openI=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedI=!0},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.buscar=function(){var data={date:dateForamat($scope.fecha)};$scope.fecha?rangeDate($scope.fecha)?(obtenerInsumos(data),$modalInstance.dismiss("cancel")):$scope.alert={type:"danger",msg:"No es posible consultar una fecha superior a la actual"}:$scope.alert={type:"danger",msg:"Seleccione fecha a consultar"}},$scope.closeAlert=function(){$scope.alert={}}}),angular.module("deposito").controller("kardexController",function($scope,$http,$modal){$scope.movimientos=[],$scope.cRegistro="5",$scope.insumoInfo=insumoKardex;var obtenerKardex=function(filter){if(filter)filter.insumo=insumoKardex.id,filter.dateI=filter.dateI?filter.dateI:insumoKardex.dateI,filter.dateF=filter.dateF?filter.dateF:insumoKardex.dateF;else var filter={insumo:insumoKardex.id,dateI:insumoKardex.dateI,dateF:insumoKardex.dateF};$scope.insumoInfo={insumo:filter.insumo,dateI:filter.dateI,dateF:filter.dateF},$http.post("/inventario/kardex/getKardex",filter).success(function(response){
$scope.movimientos=response.kardex})};$scope.filterPanel=function(){$scope.barSearch=!$scope.barSearch,$scope.filtro={}},$scope.detallesNota=function(type,index,inv){if("entrada"==type)if(inv)var search={view:"/inventario/herramientas/detallesCarga",data:"/inventario/herramientas/getInventarioCarga/",id:index};else var search={view:"/entradas/detalles",data:"/entradas/getEntrada/",id:index};else var search={view:"/detallesSalida",data:"/getSalida/",id:index};$modal.open({animation:!0,templateUrl:search.view,controller:"detallesNotaCtrl",windowClass:"large-Modal",resolve:{search:function(){return search}}})},$scope.search=function(){$modal.open({animation:!0,templateUrl:"/inventario/kardex/search",controller:"searchKardexCtrl",windowClass:"large-Modal",resolve:{obtenerKardex:function(){return obtenerKardex}}})},$scope.update=function(){obtenerKardex()},obtenerKardex()}),angular.module("deposito").controller("detallesNotaCtrl",function($scope,$modalInstance,$http,search){$scope.insumos=[],$scope.visibility=!1,$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.chvisibility=function(){$scope.search={},$scope.visibility=!$scope.visibility},$scope.detalles=function(){$http.get(search.data+search.id).success(function(response){$scope.nota=response.nota,$scope.insumos=response.insumos})},$scope.detalles()}),angular.module("deposito").controller("searchKardexCtrl",function($scope,$modalInstance,$http,obtenerKardex){function dateForamat(data){if(null!=data){var month=data.getMonth()+1,day=data.getDate();return 10>day&&(day="0"+day),10>month&&(month="0"+month),data.getFullYear()+"-"+month+"-"+day}}function timeFormat(time){var hour=time.getHours(),minute=time.getMinutes();return 10>hour&&(hour="0"+hour),10>minute&&(minute="0"+minute),hour+"-"+minute}$scope.data={},$scope.type="all",$scope.comcp="all",$scope.insumoSelect={},$scope.userSelect={},$scope.proveSelect={},$http.get("/getUsuariosDeposito").success(function(response){var usuarios=response,userSet=[];for(var index in usuarios){var usuario={nombre:usuarios[index].nombre+" "+usuarios[index].apellido,id:usuarios[index].id};userSet.push(usuario)}$scope.usuarios=userSet}),$scope.refreshInsumos=function(insumo){$scope.searchAjax=!0;var params={insumo:insumo};return $http.get("/inventario/getInsumosInventario",{params:params}).then(function(response){$scope.listInsumos=response.data})},$scope.buscar=function(){parseType(),parseAmount(),parseUser(),parseProve(),parseDate(),parseTime(),obtenerKardex($scope.data),$modalInstance.dismiss("cancel")},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.insumoSearch=function(){$scope.insumop=!$scope.insumop},$scope.dateSearch=function(){$scope.datep=!$scope.datep},$scope.timeSearch=function(){$scope.timep=!$scope.timep,$scope.timeI=new Date,$scope.timeF=new Date},$scope.amounSearch=function(){$scope.amounp=!$scope.amounp},$scope.openI=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedI=!0},$scope.openF=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedF=!0},$scope.moviType=function(type){"entrada"==type?($scope.comcpp=!0,$scope.provedorp=!1):($scope.comcpp=!1,$scope.provedorp=!0,$scope.proveSelect={},$http.get("/getDepartamentos").success(function(response){$scope.provedores=response}))},$scope.comcpType=function(type){"all"!=type?"devolucion"==type?($scope.proveSelect={},$scope.provedorp=!0,$http.get("/getDepartamentos").success(function(response){$scope.provedores=response})):($scope.proveSelect={},$scope.provedorp=!0,$http.get("/getProvedores").success(function(response){$scope.provedores=response})):$scope.provedorp=!1};var parseType=function(){"all"!=$scope.type&&($scope.data.type=$scope.type),"entrada"==$scope.type&&"all"!=$scope.comcp&&($scope.data.comcp=$scope.comcp)},parseAmount=function(){$scope.data.cantidadI&&$scope.data.cantidadF&&($scope.data.amountrange=!0)},parseUser=function(){$scope.userSelect.hasOwnProperty("selected")&&($scope.data.user=$scope.userSelect.selected.id)},parseProve=function(){$scope.proveSelect.hasOwnProperty("selected")&&($scope.data.provedor=$scope.proveSelect.selected.id)},parseDate=function(){$scope.datep&&$scope.fechaI&&$scope.fechaF&&($scope.data.dateI=dateForamat($scope.fechaI),$scope.data.dateF=dateForamat($scope.fechaF),$scope.data.dateranger=!0)},parseTime=function(){$scope.timep&&($scope.data.horaI=timeFormat($scope.timeI),$scope.data.horaF=timeFormat($scope.timeF),$scope.data.hourrange=!0)}}),angular.module("deposito").controller("modifiEntradasController",function($scope,$http,$modal){$scope.entradas=[],$scope.cRegistro="5",$scope.obtenerEntradas=function(){$http.get("/modificaciones/getEntradas").success(function(response){$scope.entradas=response})},$scope.registrarModificacion=function(){$modal.open({animation:!0,templateUrl:"/modificaciones/registrarEntrada",windowClass:"large-Modal",controller:"registraModificacionEntradaCtrl",resolve:{obtenerEntradas:function(){return $scope.obtenerEntradas}}})},$scope.detallesModificacion=function(index){$modal.open({animation:!0,templateUrl:"/modificaciones/detallesEntrada",controller:"detallesModificacionEntradaCtrl",windowClass:"large-Modal",resolve:{id:function(){return index}}})},$scope.obtenerEntradas()}),angular.module("deposito").controller("registraModificacionEntradaCtrl",function($scope,$modalInstance,$http,obtenerEntradas){function marcaInsumos(ids){var index,id;for(index in $scope.insumos)$scope.insumos[index].style="";for(id in ids)for(index=0;index<$scope.insumos.length;index++)if($scope.insumos[index].id==ids[id]){$scope.insumos[index].style="danger";break}}function serializeInsumos(){var index,insumos=[];for(index in $scope.insumos)insumos.push({id:$scope.insumos[index].id,cantidad:$scope.insumos[index].modificacion});return insumos}$scope.btnVisivilidad=!0,$scope.alert={},$scope.codigo="",$scope.orden="",$scope.provedor="",$scope.entrada={},$scope.insumos=[],$scope.status=!1,$scope.provedores=[],$http.get("/getProvedores").success(function(response){$scope.provedores=response}),$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(){$scope.alert={}},$scope.ubicarEntrada=function(){""==$scope.codigo?$scope.alert={type:"danger",msg:"Espefifique un codigo de Pro-Forma"}:$http.get("/entradas/getCodigo/"+$scope.codigo).success(function(response){return"danger"==response.status?void($scope.alert={type:response.status,msg:response.menssage}):($scope.entrada=response.entrada,$scope.insumos=response.insumos,$scope.alert={},void($scope.status=!0))})},$scope.save=function(){var $data={entrada:$scope.entrada.id,orden:$scope.orden,provedor:$scope.provedor,insumos:serializeInsumos()};$http.post("/modificaciones/registrarEntrada",$data).success(function(response){return $scope.alert={},"unexist"==response.status?(marcaInsumos(response.data),void($scope.alert={type:"danger",msg:"La cantidad de los insumos marcados no puede ser modificada por este monto, por favor verifique el inventario"})):($scope.alert={type:response.status,msg:response.menssage},void("success"==response.status&&($scope.btnVisivilidad=!1,obtenerEntradas())))})}}),angular.module("deposito").controller("detallesModificacionEntradaCtrl",function($scope,$modalInstance,$http,id){$scope.entrada={},$scope.insumos=[],$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.detalles=function(){$http.get("/modificaciones/getEntradas/"+id).success(function(response){$scope.modificacion=response.modificacion,$scope.entrada=response.entrada,$scope.insumos=response.insumos})},$scope.detalles(id)}),angular.module("deposito").controller("modifiSalidasController",function($scope,$http,$modal){$scope.salidas=[],$scope.cRegistro="5",$scope.obtenerSalidas=function(){$http.get("/modificaciones/getSalidas").success(function(response){$scope.salidas=response})},$scope.registrarModificacion=function(){$modal.open({animation:!0,templateUrl:"/modificaciones/registrarSalida",windowClass:"large-Modal",controller:"registraModificacionSalidaCtrl",resolve:{obtenerSalidas:function(){return $scope.obtenerSalidas}}})},$scope.detallesModificacion=function(index){$modal.open({animation:!0,templateUrl:"/modificaciones/detallesSalida",controller:"detallesModificacionSalidaCtrl",windowClass:"large-Modal",resolve:{id:function(){return index}}})},$scope.obtenerSalidas()}),angular.module("deposito").controller("registraModificacionSalidaCtrl",function($scope,$modalInstance,$http,obtenerSalidas){function marcaInsumos(ids){var index,id;for(index in $scope.insumos)$scope.insumos[index].style="";for(id in ids)for(index=0;index<$scope.insumos.length;index++)if($scope.insumos[index].id==ids[id]){$scope.insumos[index].style="danger";break}}function serializeInsumos(){var index,insumos=[];for(index in $scope.insumos)insumos.push({id:$scope.insumos[index].id,solicitado:$scope.insumos[index].Msolicitado,despachado:$scope.insumos[index].Mdespachado});return insumos}$scope.btnVisivilidad=!0,$scope.alert={},$scope.codigo="",$scope.orden="",$scope.departamento="",$scope.salida={},$scope.insumos=[],$scope.status=!1,$scope.departamentos=[],$http.get("/getDepartamentos").success(function(response){$scope.departamentos=response}),$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(){$scope.alert={}},$scope.ubicarSalida=function(){""==$scope.codigo?$scope.alert={type:"danger",msg:"Espefifique un codigo de Pro-Forma"}:$http.get("/getSalidaCodigo/"+$scope.codigo).success(function(response){return"danger"==response.status?void($scope.alert={type:response.status,msg:response.menssage}):($scope.salida=response.salida,$scope.insumos=response.insumos,$scope.alert={},void($scope.status=!0))})},$scope.save=function(){var $data={salida:$scope.salida.id,departamento:$scope.departamento,insumos:serializeInsumos()};$http.post("/modificaciones/registrarSalida",$data).success(function(response){return $scope.alert={},"unexist"==response.status?(marcaInsumos(response.data),void($scope.alert={type:"danger",msg:"La cantidad de los insumos marcados no puede ser modificada por este monto, por favor verifique el inventario"})):($scope.alert={type:response.status,msg:response.menssage},void("success"==response.status&&($scope.btnVisivilidad=!1,obtenerSalidas())))})}}),angular.module("deposito").controller("detallesModificacionSalidaCtrl",function($scope,$modalInstance,$http,id){$scope.salida={},$scope.insumos=[],$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.detalles=function(){$http.get("/modificaciones/getSalida/"+id).success(function(response){$scope.modificacion=response.modificacion,$scope.salida=response.salida,$scope.insumos=response.insumos})},$scope.detalles(id)}),angular.module("deposito").controller("presentacionesController",function($scope,$http,$modal){$scope.presentaciones=[],$scope.registrarPresentacion=function(){$modal.open({animation:!0,templateUrl:"/registrarPresentacion",size:"lg",controller:"registraPresentacionCtrl",resolve:{obtenerPresentaciones:function(){return $scope.obtenerPresentaciones}}})},$scope.obtenerPresentaciones=function(){$http.get("/getPresentaciones").success(function(response){$scope.presentaciones=response})},$scope.editarPresentacion=function(index){$modal.open({animation:!0,templateUrl:"/editarPresentacion",size:"lg",controller:"editarPresentacionCtrl",resolve:{obtenerPresentaciones:function(){return $scope.obtenerPresentaciones},id:function(){return index}}})},$scope.eliminarPresentacion=function(index){$modal.open({animation:!0,templateUrl:"/eliminarPresentacion",controller:"eliminarPresentacionCtrl",resolve:{obtenerPresentaciones:function(){return $scope.obtenerPresentaciones},id:function(){return index}}})},$scope.obtenerPresentaciones()}),angular.module("deposito").controller("registraPresentacionCtrl",function($scope,$modalInstance,$http,obtenerPresentaciones){$scope.btnVisivilidad=!0,$scope.nombre="",$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/registrarPresentacion",$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerPresentaciones()})}}),angular.module("deposito").controller("editarPresentacionCtrl",function($scope,$modalInstance,$http,obtenerPresentaciones,id){$scope.btnVisivilidad=!0,$scope.nombre="",$http.get("/getPresentacion/"+id).success(function(response){$scope.nombre=response.nombre}),$scope.modificar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/editarPresentacion/"+id,$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerPresentaciones()})}}),angular.module("deposito").controller("eliminarPresentacionCtrl",function($scope,$modalInstance,$http,obtenerPresentaciones,id){$scope.btnVisivilidad=!0,$scope.eliminar=function(){$scope.delet()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.delet=function(){$http.post("/eliminarPresentacion/"+id).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerPresentaciones()})}}),angular.module("deposito").controller("provedoresController",function($scope,$http,$modal){$scope.provedores=[],$scope.cRegistro="5",$scope.registraProvedor=function(){$modal.open({animation:!0,templateUrl:"/registraProvedor",size:"lg",controller:"registraProvedorCtrl",resolve:{obtenerProvedores:function(){return $scope.obtenerProvedores}}})},$scope.obtenerProvedores=function(){$http.get("/getProvedores").success(function(response){$scope.provedores=response})},$scope.editarProvedor=function(index){$modal.open({animation:!0,templateUrl:"/editarProvedor",size:"lg",controller:"editarProvedorCtrl",resolve:{obtenerProvedores:function(){return $scope.obtenerProvedores},id:function(){return index}}})},$scope.elimProvedor=function(index){$modal.open({animation:!0,templateUrl:"/elimProvedor",controller:"elimProvedorCtrl",resolve:{obtenerProvedores:function(){return $scope.obtenerProvedores},id:function(){return index}}})},$scope.obtenerProvedores()}),angular.module("deposito").controller("registraProvedorCtrl",function($scope,$modalInstance,$http,obtenerProvedores){$scope.btnVisivilidad=!0,$scope.rif="",$scope.nombre="",$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={rif:$scope.rif,nombre:$scope.nombre};$http.post("/registraProvedor",$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerProvedores()})}}),angular.module("deposito").controller("editarProvedorCtrl",function($scope,$modalInstance,$http,obtenerProvedores,id){$scope.btnVisivilidad=!0,$scope.rif="",$scope.nombre="",$http.get("/getProvedor/"+id).success(function(response){$scope.rif=response.rif,$scope.nombre=response.nombre}),$scope.modificar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/editProvedor/"+id,$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerProvedores()})}}),angular.module("deposito").controller("elimProvedorCtrl",function($scope,$modalInstance,$http,obtenerProvedores,id){$scope.btnVisivilidad=!0,$scope.eliminar=function(){$scope.delet()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.delet=function(){$http.post("/elimProvedor/"+id).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerProvedores()})}}),angular.module("deposito").controller("registroEntradaController",function($scope,$http,$modal){function insumoExist(codigo,insumos){var index;for(index in insumos)if(insumos[index].codigo==codigo)return!0;return!1}function validaCantidad(insumos){var index;for(index in insumos)if(!insumos[index].cantidad||insumos[index].cantidad<0||!Number.isInteger($scope.insumos[index].cantidad))return!1;return!0}function empaquetaData(insumosOri){var index,insumos=[];for(index in insumosOri)insumos.push({id:insumosOri[index].id,cantidad:insumosOri[index].cantidad,fecha:dataForamat(insumosOri[index].fecha),lote:insumosOri[index].lote});return insumos}function dataForamat(data){if(null!=data){var month=data.getMonth()+1,day=data.getDate();return 10>day&&(day="0"+day),10>month&&(month="0"+month),data.getFullYear()+"-"+month+"-"+day}}$scope.insumoSelect={},$scope.provedores=[],$scope.departamentos=[],$scope.departamento,$scope.provedor,$scope.insumos=[],$scope.listInsumos=[],$scope.alert={},$scope.openI=function($event,dI){$event.preventDefault(),$event.stopPropagation(),$scope.insumos[dI].dI=!0},$scope.refreshInsumos=function(insumo){var params={insumo:insumo};return $http.get("/getInsumosConsulta",{params:params}).then(function(response){$scope.listInsumos=response.data})},$http.get("/getProvedores").success(function(response){$scope.provedores=response}),$http.get("/getDepartamentos").success(function(response){$scope.departamentos=response}),$scope.agregarInsumos=function(){return $scope.insumoSelect.selected?insumoExist($scope.insumoSelect.selected.codigo,$scope.insumos)?void($scope.alert={type:"danger",msg:"Este insumo ya se ha agregado en esta entrada"}):($scope.insumos.unshift({id:$scope.insumoSelect.selected.id,codigo:$scope.insumoSelect.selected.codigo,descripcion:$scope.insumoSelect.selected.descripcion,dI:null}),void($scope.insumoSelect={})):void($scope.alert={type:"danger",msg:"Por favor especifique un insumo"})},$scope.registrar=function(datos){return validaCantidad($scope.insumos)?($scope.modalInstance=$modal.open({animation:!0,templateUrl:"confirmeRegister.html",scope:$scope}),$scope.cancel=function(){$scope.modalInstance.dismiss("cancel")},void($scope.cofirme=function(){save(datos),$scope.modalInstance.dismiss("cancel"),$scope.loader=!0})):void($scope.alert={type:"danger",msg:"Especifique un valor valido para cada insumo"})};var save=function(datos){switch(datos){case"orden":var data={orden:$scope.orden,provedor:$scope.provedor,insumos:empaquetaData($scope.insumos)},origen="/entradas/registrar/orden";break;case"donacion":var data={provedor:$scope.provedor,insumos:empaquetaData($scope.insumos)},origen="/entradas/registrar/donacion";break;case"devolucion":var data={departamento:$scope.departamento,insumos:empaquetaData($scope.insumos)},origen="/entradas/registrar/devolucion"}$http.post(origen,data).success(function(response){return $scope.loader=!1,"success"==response.status?($modal.open({animation:!0,templateUrl:"successRegister.html",controller:"successRegisterCtrl",resolve:{response:function(){return response}}}),void $scope.restablecer()):void($scope.alert={type:response.status,msg:response.menssage})})};$scope.eliminarInsumo=function(index){$scope.insumos.splice(index,1)},$scope.closeAlert=function(){$scope.alert={}},$scope.thereInsumos=function(){return $scope.insumos.length>0},$scope.restablecer=function(){$scope.insumos=[],$scope.orden="",$scope.departamento="",$scope.provedor="",$scope.alert={}}}),angular.module("deposito").controller("successRegisterCtrl",function($scope,$modalInstance,response){$scope.response=response,$scope.ok=function(){$modalInstance.dismiss("cancel")}}),angular.module("deposito").controller("registroSalidaController",function($scope,$http,$modal){function insumoExist(codigo){var index;for(index in $scope.insumos)if($scope.insumos[index].codigo==codigo)return!0;return!1}function validaCantidad(){var index;for(index in $scope.insumos)if(!$scope.insumos[index].despachado||$scope.insumos[index].despachado<0||!Number.isInteger($scope.insumos[index].despachado)||$scope.insumos[index].solicitado<$scope.insumos[index].despachado)return!1;return!0}function empaquetaData(){var index,insumos=[];for(index in $scope.insumos)insumos.push({id:$scope.insumos[index].id,solicitado:$scope.insumos[index].solicitado,despachado:$scope.insumos[index].despachado});return insumos}function marcaInsumos(ids){var index,id;for(index in $scope.insumos)$scope.insumos[index].style="";for(id in ids)for(index=0;index<$scope.insumos.length;index++)if($scope.insumos[index].id==ids[id]){$scope.insumos[index].style="danger";break}}function restablecer(){$scope.insumos=[],$scope.servicio="",$scope.alert={}}$scope.insumoSelect={},$scope.departamentos=[],$scope.listInsumos=[],$scope.servicio="",$scope.insumos=[],$scope.alert={},$scope.refreshInsumos=function(insumo){var params={insumo:insumo};return $http.get("inventario/getInsumosInventario",{params:params}).then(function(response){$scope.listInsumos=response.data})},$http.get("/getDepartamentos").success(function(response){$scope.departamentos=response}),$scope.agregarInsumos=function(){return $scope.insumoSelect.selected?insumoExist($scope.insumoSelect.selected.codigo)?void($scope.alert={type:"danger",msg:"Este insumo ya se ha agregado en esta entrada"}):($scope.insumos.unshift({id:$scope.insumoSelect.selected.id,codigo:$scope.insumoSelect.selected.codigo,descripcion:$scope.insumoSelect.selected.descripcion}),void($scope.insumoSelect={})):void($scope.alert={type:"danger",msg:"Por favor especifique un insumo"})},$scope.registrar=function(){return validaCantidad()?($scope.modalInstance=$modal.open({animation:!0,templateUrl:"confirmeRegister.html",scope:$scope}),$scope.cancel=function(){$scope.modalInstance.dismiss("cancel")},void($scope.cofirme=function(){save(),$scope.modalInstance.dismiss("cancel"),$scope.loader=!0})):void($scope.alert={type:"danger",msg:"Especifique valores validos para cada insumo"})};var save=function($data){var $data={departamento:$scope.servicio,insumos:empaquetaData()};$http.post("/registrarSalida",$data).success(function(response){return $scope.loader=!1,"unexist"==response.status?(marcaInsumos(response.data),void($scope.alert={type:"danger",msg:"La cantidad de los insumos marcados son insuficientes"})):"success"==response.status?($modal.open({animation:!0,templateUrl:"successRegister.html",controller:"successRegisterCtrl",resolve:{response:function(){return response}}}),void restablecer()):void($scope.alert={type:response.status,msg:response.menssage})})};$scope.eliminarInsumo=function(index){$scope.insumos.splice(index,1)},$scope.closeAlert=function(){$scope.alert={}},$scope.thereInsumos=function(){return $scope.insumos.length>0}}),angular.module("deposito").controller("successRegisterCtrl",function($scope,$modalInstance,response){$scope.response=response,$scope.ok=function(){$modalInstance.dismiss("cancel")}}),angular.module("deposito").controller("salidasController",function($scope,$http,$modal){$scope.salidas=[],$scope.indice="Pro-Formas",$scope.salidasInsumos=[],$scope.cRegistro="5",$scope.status=!0,$scope.obtenerSalidas=function(type,query){"search"==type?$http.get("/getSearch",query).success(function(response){$scope.salidas=response}):$http.get("/getSalidas").success(function(response){$scope.salidas=response})},$scope.obtenerSalidasInsumos=function(){$http.get("/getInsumosSalidas").success(function(response){$scope.salidasInsumos=response})},$scope.registrosProformas=function(){$scope.busqueda="",$scope.indice="Pro-Formas",$scope.salidasInsumos=[],$scope.status=!0,$scope.obtenerSalidas()},$scope.registrosInsumos=function(){$scope.busqueda="",$scope.indice="Insumos",$scope.insumos=[],$scope.status=!1,$scope.obtenerSalidasInsumos()},$scope.detallesSalida=function(index){$modal.open({animation:!0,templateUrl:"/detallesSalida",controller:"detallesSalidaCtrl",windowClass:"large-Modal",resolve:{id:function(){return index}}})},$scope.search=function(){$scope.status=!0;$modal.open({animation:!0,templateUrl:"/search",controller:"serarchSalidaCtrl",windowClass:"large-Modal",resolve:{obtenerSalidas:function(){return $scope.obtenerSalidas}}})},$scope.obtenerSalidas()}),angular.module("deposito").controller("detallesSalidaCtrl",function($scope,$modalInstance,$http,id){$scope.salida={},$scope.insumos=[],$scope.visibility=!1,$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.chvisibility=function(){$scope.search={},$scope.visibility=!$scope.visibility},$scope.detalles=function(){$http.get("/getSalida/"+id).success(function(response){$scope.nota=response.nota,$scope.insumos=response.insumos})},$scope.detalles(id)}),angular.module("deposito").controller("serarchSalidaCtrl",function($scope,$modalInstance,$http,obtenerSalidas){function dateForamat(data){if(null!=data){var month=data.getMonth()+1,day=data.getDate();return 10>day&&(day="0"+day),10>month&&(month="0"+month),data.getFullYear()+"-"+month+"-"+day}}function timeFormat(time){var hour=time.getHours(),minute=time.getMinutes();return 10>hour&&(hour="0"+hour),10>minute&&(minute="0"+minute),hour+"-"+minute}$scope.data={},$scope.insumoSelect={},$scope.departSelect={},$scope.userSelect={},$scope.data.orden="desc",$http.get("getUsuariosDeposito").success(function(response){$scope.usuarios=response}),$http.get("/getDepartamentos").success(function(response){$scope.departamentos=response}),$scope.refreshInsumos=function(insumo){var params={insumo:insumo};return $http.get("inventario/getInsumosInventario",{params:params}).then(function(response){$scope.listInsumos=response.data})},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.insumoSearch=function(){$scope.insumop=!$scope.insumop},$scope.dateSearch=function(){$scope.datep=!$scope.datep},$scope.timeSearch=function(){$scope.timep=!$scope.timep,$scope.timeI=new Date,$scope.timeF=new Date},$scope.openI=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedI=!0},$scope.openF=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedF=!0},$scope.buscar=function(){parseDepart(),parseUser(),parseInsumo(),parseAmount(),parseDate(),parseTime();var config={params:$scope.data};obtenerSalidas("search",config),$modalInstance.dismiss("cancel")};var parseDepart=function(){$scope.departSelect.hasOwnProperty("selected")&&($scope.data.depart=$scope.departSelect.selected.id)},parseInsumo=function(){$scope.insumop&&$scope.insumoSelect.hasOwnProperty("selected")&&($scope.data.insumo=$scope.insumoSelect.selected.id)},parseAmount=function(){$scope.data.cantidadI&&$scope.data.cantidadF&&($scope.data.amountrange=!0)},parseUser=function(){$scope.userSelect.hasOwnProperty("selected")&&($scope.data.user=$scope.userSelect.selected.id)},parseDate=function(){$scope.datep&&$scope.fechaI&&$scope.fechaF&&($scope.data.fechaI=dateForamat($scope.fechaI),$scope.data.fechaF=dateForamat($scope.fechaF),$scope.data.dateranger=!0)},parseTime=function(){$scope.timep&&($scope.data.horaI=timeFormat($scope.timeI),$scope.data.horaF=timeFormat($scope.timeF),$scope.data.hourrange=!0)}}),angular.module("deposito").controller("seccionesController",function($scope,$http,$modal){$scope.secciones=[],$scope.registrarSeccion=function(){$modal.open({animation:!0,templateUrl:"/registrarSeccion",size:"lg",controller:"registraSeccionCtrl",resolve:{obtenerSecciones:function(){return $scope.obtenerSecciones}}})},$scope.obtenerSecciones=function(){$http.get("/getSecciones").success(function(response){$scope.secciones=response})},$scope.editarSeccion=function(index){$modal.open({animation:!0,templateUrl:"/editarSeccion",size:"lg",controller:"editarSeccionCtrl",resolve:{obtenerSecciones:function(){return $scope.obtenerSecciones},id:function(){return index}}})},$scope.eliminarSeccion=function(index){$modal.open({animation:!0,templateUrl:"/eliminarSeccion",controller:"eliminarSeccionesCtrl",resolve:{obtenerSecciones:function(){return $scope.obtenerSecciones},id:function(){return index}}})},$scope.obtenerSecciones()}),angular.module("deposito").controller("registraSeccionCtrl",function($scope,$modalInstance,$http,obtenerSecciones){$scope.btnVisivilidad=!0,$scope.nombre="",$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/registrarSeccion",$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerSecciones()})}}),angular.module("deposito").controller("editarSeccionCtrl",function($scope,$modalInstance,$http,obtenerSecciones,id){$scope.btnVisivilidad=!0,$scope.nombre="",$http.get("/getSeccion/"+id).success(function(response){$scope.nombre=response.nombre}),$scope.modificar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/editarSeccion/"+id,$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerSecciones()})}}),angular.module("deposito").controller("eliminarSeccionesCtrl",function($scope,$modalInstance,$http,obtenerSecciones,id){$scope.btnVisivilidad=!0,$scope.eliminar=function(){$scope.delet()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.delet=function(){$http.post("/eliminarSeccion/"+id).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerSecciones()})}}),angular.module("deposito").controller("unidadMedidasController",function($scope,$http,$modal){$scope.unidadMedidas=[],$scope.registrarUnidadMedida=function(){$modal.open({animation:!0,templateUrl:"/registrarMedida",size:"lg",controller:"registrarMedidaCtrl",resolve:{obtenerUnidadMedidas:function(){return $scope.obtenerUnidadMedidas}}})},$scope.obtenerUnidadMedidas=function(){$http.get("/getMedidas").success(function(response){$scope.unidadMedidas=response})},$scope.editarUnidadMedida=function(index){$modal.open({animation:!0,templateUrl:"/editarMedida",size:"lg",controller:"editarMedidaCtrl",resolve:{obtenerUnidadMedidas:function(){return $scope.obtenerUnidadMedidas},id:function(){return index}}})},$scope.eliminarUnidadMedida=function(index){$modal.open({animation:!0,templateUrl:"/eliminarMedida",controller:"eliminarMedidaCtrl",resolve:{obtenerUnidadMedidas:function(){return $scope.obtenerUnidadMedidas},id:function(){return index}}})},$scope.obtenerUnidadMedidas()}),angular.module("deposito").controller("registrarMedidaCtrl",function($scope,$modalInstance,$http,obtenerUnidadMedidas){$scope.btnVisivilidad=!0,$scope.nombre="",$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/registrarMedida",$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage
}),$scope.btnVisivilidad="success"!=response.status,obtenerUnidadMedidas()})}}),angular.module("deposito").controller("editarMedidaCtrl",function($scope,$modalInstance,$http,obtenerUnidadMedidas,id){$scope.btnVisivilidad=!0,$scope.nombre="",$http.get("/getMedida/"+id).success(function(response){$scope.nombre=response.nombre}),$scope.modificar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){var $data={nombre:$scope.nombre};$http.post("/editarMedida/"+id,$data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerUnidadMedidas()})}}),angular.module("deposito").controller("eliminarMedidaCtrl",function($scope,$modalInstance,$http,obtenerUnidadMedidas,id){$scope.btnVisivilidad=!0,$scope.eliminar=function(){$scope.delet()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.delet=function(){$http.post("/eliminarMedida/"+id).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerUnidadMedidas()})}}),angular.module("deposito").controller("usersController",function($scope,$http,$modal){$scope.usuarios=[],$scope.cRegistro="5",$scope.registrarUser=function(){$modal.open({animation:!0,templateUrl:"/registrarUser",windowClass:"large-Modal",controller:"registraUsuarioCtrl",resolve:{obtenerUsuarios:function(){return $scope.obtenerUsuarios}}})},$scope.obtenerUsuarios=function(){$http.get("/getUsuarios").success(function(response){$scope.usuarios=response})},$scope.editarUsuario=function(index){$modal.open({animation:!0,templateUrl:"/editarUsuario",windowClass:"large-Modal",controller:"editarUsuarioCtrl",resolve:{obtenerUsuarios:function(){return $scope.obtenerUsuarios},id:function(){return index}}})},$scope.elimUsuario=function(index){$modal.open({animation:!0,templateUrl:"/eliminarUsuario",controller:"elimUsuarioCtrl",resolve:{obtenerUsuarios:function(){return $scope.obtenerUsuarios},id:function(){return index}}})},$scope.obtenerUsuarios()}),angular.module("deposito").controller("registraUsuarioCtrl",function($scope,$modalInstance,$http,obtenerUsuarios){$scope.btnVisivilidad=!0,$scope.depositos=[],$http.get("/depositos/getDepositos").success(function(response){$scope.depositos=response}),$scope.data={pUsuario:!1,pUsuarioR:!1,pUsuarioM:!1,pUsuarioE:!1,pProvedor:!1,pProvedorR:!1,pProvedorM:!1,pProvedorE:!1,pDepartamento:!1,pDepartamentoR:!1,pDepartamentoM:!1,pDepartamentoE:!1,pInsumo:!1,pInsumoR:!1,pInsumoM:!1,pInsumoE:!1,pInventario:!1,pInventarioH:!1,pModificacion:!1,pEntradaR:!1,pEntradaV:!1,pSalidaR:!1,pSalidaV:!1,pEstadistica:!1,pDeposito:!1,pDepositoR:!1,pDepositoM:!1,pDepositoE:!1,pTranference:!1},$scope.usuarioActive=function(){1==$scope.data.pUsuario?($scope.data.pUsuarioR=!0,$scope.data.pUsuarioM=!0,$scope.data.pUsuarioE=!0):($scope.data.pUsuarioR=!1,$scope.data.pUsuarioM=!1,$scope.data.pUsuarioE=!1)},$scope.provedorActive=function(){1==$scope.data.pProvedor?($scope.data.pProvedorR=!0,$scope.data.pProvedorM=!0,$scope.data.pProvedorE=!0):($scope.data.pProvedorR=!1,$scope.data.pProvedorM=!1,$scope.data.pProvedorE=!1)},$scope.departamentoActive=function(){1==$scope.data.pDepartamento?($scope.data.pDepartamentoR=!0,$scope.data.pDepartamentoM=!0,$scope.data.pDepartamentoE=!0):($scope.data.pDepartamentoR=!1,$scope.data.pDepartamentoM=!1,$scope.data.pDepartamentoE=!1)},$scope.insumoActive=function(){1==$scope.data.pInsumo?($scope.data.pInsumoR=!0,$scope.data.pInsumoM=!0,$scope.data.pInsumoE=!0):($scope.data.pInsumoR=!1,$scope.data.pInsumoM=!1,$scope.data.pInsumoE=!1)},$scope.inventarioActive=function(){1==$scope.data.pInventario?($scope.data.pInventarioH=!0,$scope.data.pEntradaV=!0,$scope.data.pSalidaV=!0):($scope.data.pInventarioH=!1,$scope.data.pEntradaV=!1,$scope.data.pSalidaV=!1)},$scope.tranferenciaActive=function(){1==$scope.data.pTranference?($scope.data.pEntradaR=!0,$scope.data.pSalidaR=!0):($scope.data.pEntradaR=!1,$scope.data.pSalidaR=!1)},$scope.depositoActive=function(){1==$scope.data.pDeposito?($scope.data.pDepositoR=!0,$scope.data.pDepositoM=!0,$scope.data.pDepositoE=!0):($scope.data.pDepositoR=!1,$scope.data.pDepositoM=!1,$scope.data.pDepositoE=!1)},$scope.registrar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){$http.post("/registrarUsuario",$scope.data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerUsuarios()})}}),angular.module("deposito").controller("editarUsuarioCtrl",function($scope,$modalInstance,$http,obtenerUsuarios,id){$scope.btnVisivilidad=!0,$scope.data={},$scope.depositos=[],$http.get("/depositos/getDepositos").success(function(response){$scope.depositos=response}),$http.get("/getUsuario/"+id).success(function(response){var usuario=response.usuario;usuario.pUsuario=1==usuario.pUsuario,usuario.pUsuarioR=1==usuario.pUsuarioR,usuario.pUsuarioM=1==usuario.pUsuarioM,usuario.pUsuarioE=1==usuario.pUsuarioE,usuario.pProvedor=1==usuario.pProvedor,usuario.pProvedorR=1==usuario.pProvedorR,usuario.pProvedorM=1==usuario.pProvedorM,usuario.pProvedorE=1==usuario.pProvedorE,usuario.pDepartamento=1==usuario.pDepartamento,usuario.pDepartamentoR=1==usuario.pDepartamentoR,usuario.pDepartamentoM=1==usuario.pDepartamentoM,usuario.pDepartamentoE=1==usuario.pDepartamentoE,usuario.pInsumo=1==usuario.pInsumo,usuario.pInsumoR=1==usuario.pInsumoR,usuario.pInsumoM=1==usuario.pInsumoM,usuario.pInsumoE=1==usuario.pInsumoE,usuario.pInventario=1==usuario.pInventario,usuario.pInventarioH=1==usuario.pInventarioH,usuario.pModificacion=1==usuario.pModificacion,usuario.pEntradaR=1==usuario.pEntradaR,usuario.pEntradaV=1==usuario.pEntradaV,usuario.pTranference=!(!usuario.pSalidaR&&!usuario.pEntradaR),usuario.pSalidaR=1==usuario.pSalidaR,usuario.pSalidaV=1==usuario.pSalidaV,usuario.pEstadistica=1==usuario.pEstadistica,usuario.pDeposito=1==usuario.pDeposito,usuario.pDepositoR=1==usuario.pDepositoR,usuario.pDepositoM=1==usuario.pDepositoM,usuario.pDepositoE=1==usuario.pDepositoE,$scope.data=usuario}),$scope.usuarioActive=function(){1==$scope.data.pUsuario?($scope.data.pUsuarioR=!0,$scope.data.pUsuarioM=!0,$scope.data.pUsuarioE=!0):($scope.data.pUsuarioR=!1,$scope.data.pUsuarioM=!1,$scope.data.pUsuarioE=!1)},$scope.provedorActive=function(){1==$scope.data.pProvedor?($scope.data.pProvedorR=!0,$scope.data.pProvedorM=!0,$scope.data.pProvedorE=!0):($scope.data.pProvedorR=!1,$scope.data.pProvedorM=!1,$scope.data.pProvedorE=!1)},$scope.departamentoActive=function(){1==$scope.data.pDepartamento?($scope.data.pDepartamentoR=!0,$scope.data.pDepartamentoM=!0,$scope.data.pDepartamentoE=!0):($scope.data.pDepartamentoR=!1,$scope.data.pDepartamentoM=!1,$scope.data.pDepartamentoE=!1)},$scope.insumoActive=function(){1==$scope.data.pInsumo?($scope.data.pInsumoR=!0,$scope.data.pInsumoM=!0,$scope.data.pInsumoE=!0):($scope.data.pInsumoR=!1,$scope.data.pInsumoM=!1,$scope.data.pInsumoE=!1)},$scope.inventarioActive=function(){1==$scope.data.pInventario?$scope.data.pInventarioH=!0:$scope.data.pInventarioH=!1},$scope.tranferenciaActive=function(){1==$scope.data.pTranference?($scope.data.pEntradaR=!0,$scope.data.pSalidaR=!0):($scope.data.pEntradaR=!1,$scope.data.pSalidaR=!1)},$scope.entradaActive=function(){1==$scope.data.pEntrada?($scope.data.pEntradaV=!0,$scope.data.pEntradaR=!0):($scope.data.pEntradaV=!1,$scope.data.pEntradaR=!1)},$scope.salidaActive=function(){1==$scope.data.pSalida?($scope.data.pSalidaV=!0,$scope.data.pSalidaR=!0):($scope.data.pSalidaV=!1,$scope.data.pSalidaR=!1)},$scope.depositoActive=function(){1==$scope.data.pDeposito?($scope.data.pDepositoR=!0,$scope.data.pDepositoM=!0,$scope.data.pDepositoE=!0):($scope.data.pDepositoR=!1,$scope.data.pDepositoM=!1,$scope.data.pDepositoE=!1)},$scope.modificar=function(){$scope.save()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.save=function(){$http.post("/editarUsuario/"+id,$scope.data).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerUsuarios()})}}),angular.module("deposito").controller("elimUsuarioCtrl",function($scope,$modalInstance,$http,obtenerUsuarios,id){$scope.btnVisivilidad=!0,$scope.eliminar=function(){$scope.delet()},$scope.cancelar=function(){$modalInstance.dismiss("cancel")},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.delet=function(){$http.post("/eliminarUsuario/"+id).success(function(response){$scope.alerts=[],$scope.alerts.push({type:response.status,msg:response.menssage}),$scope.btnVisivilidad="success"!=response.status,obtenerUsuarios()})}});